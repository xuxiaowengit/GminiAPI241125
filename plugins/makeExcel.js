var today=new Date;const XLSX=require("xlsx"),generateLog=require("./logger"),path=require("path"),{createExcelFile:createExcelFile,worksheetExists:worksheetExists,appendWorksheetToFile:appendWorksheetToFile}=require("./outFile"),fs=require("fs"),logFilePath=path.join(__dirname,"./log/appRun.log");module.exports.asyncFunction=function(e,o,t){setTimeout((()=>{const l=o.fullDate,i=o.dayHour,a=[["邮箱","网站","相关属性","判定","备注","时间"]];if(fs.existsSync(o.outfilePath)){console.log("表1已经存在",l);const e=XLSX.readFile(o.outfilePath);worksheetExists(e,l)?console.log("工作表1表名存在,数据直接追加到工作表:",l):(appendWorksheetToFile(o.outfilePath,o.outfilePath,i,a),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,`工作表1存在,表名不存在,新建立工作表--${o.nowTime}`))}else console.log(a,o.outfilePath,l),createExcelFile(a,o.outfilePath,l),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,`表1文件不存在,新建立表文件--${o.nowTime}`);const s=o.fullDate,n=o.dayHour,r=[["邮箱","网站","关键词","相关属性","判断结论"]];if(fs.existsSync(o.outfilePath2)){console.log("表2已经存在",o.outfilePath2);const e=XLSX.readFile(o.outfilePath2);worksheetExists(e,s)?console.log("工作表2名存在,数据直接追加到工作表:",s):(appendWorksheetToFile(o.outfilePath2,o.outfilePath2,n,r),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,`工作表2在,表名${s}不存在,新建立工作表--${o.nowTime}`))}else createExcelFile(r,o.outfilePath2,s),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,`表2文件不存在,新建立表文件--${o.nowTime}`);t(null,e+" 异步回调执行完毕返回")}),1)};