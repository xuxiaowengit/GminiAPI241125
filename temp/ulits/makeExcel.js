var today=new Date;const XLSX=require("xlsx"),generateLog=require("./logger"),path=require("path"),{createExcelFile:createExcelFile,worksheetExists:worksheetExists,appendWorksheetToFile:appendWorksheetToFile}=require("./outFile"),fs=require("fs"),logFilePath=path.join(__dirname,"./log/appRun.log");module.exports.asyncFunction=function(e,o,t){setTimeout((()=>{var l=o.fullDate,i=o.dayHour,a=[["邮箱","网站","相关属性","判定","备注","时间"]],s=(fs.existsSync(o.outfilePath)?(console.log("表1已经存在",l),s=XLSX.readFile(o.outfilePath),worksheetExists(s,l)?console.log("工作表1表名存在,数据直接追加到工作表:",l):(appendWorksheetToFile(o.outfilePath,o.outfilePath,i,a),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,"工作表1存在,表名不存在,新建立工作表--"+o.nowTime))):(console.log(a,o.outfilePath,l),createExcelFile(a,o.outfilePath,l),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,"表1文件不存在,新建立表文件--"+o.nowTime)),o.fullDate);i=o.dayHour,a=[["邮箱","网站","关键词","相关属性","判断结论"]];fs.existsSync(o.outfilePath2)?(console.log("表2已经存在",o.outfilePath2),l=XLSX.readFile(o.outfilePath2),worksheetExists(l,s)?console.log("工作表2名存在,数据直接追加到工作表:",s):(appendWorksheetToFile(o.outfilePath2,o.outfilePath2,i,a),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,"工作表2在,表名"+s+"不存在,新建立工作表--"+o.nowTime))):(createExcelFile(a,o.outfilePath2,s),today=new Date,milliseconds=today.getMilliseconds(),generateLog(logFilePath,"表2文件不存在,新建立表文件--"+o.nowTime)),t(null,e+" 异步回调执行完毕返回")}),1)};