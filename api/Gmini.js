const propertyChecker=require("../plugins/inTypeOf"),axios=require("axios");let apiIndex=0;async function generateContent(e){const t=["AIzaSyATivobv6PlkD-cnIJ8k1lgEuXk_t4AFxM","AIzaSyCBCJqcFJPWfVnxmwv2kiDX1Mb7hLLYYew","AIzaSyDiyqOVlm4ticaSmMwpuR1UteI43ytXvCY","AIzaSyC8INbh50rAr5ZJQ1L22iA0pQs-QhHxSOI","AIzaSyBS6tmfrFeLomXZPlBs7cczYEjzVFsHZVw","AIzaSyBmx7fmSC8qU5kKQNsPbOhBn_94j4kyo6k","AIzaSyBt2fCaVg7eZ6SYf1Rq422MKSENfZNy2go","AIzaSyDSPDWVm8CYm83DJfZi8bH7efb2XBluEOU","AIzaSyC8afxCESfdgXGzmnEhyBnCSwcIGt5OkCg","AIzaSyB4qZJnusenRsaTKMF-r3hg_MX9U2UKxPI","AIzaSyCLXD-5x5yEep-W93d93qXyAsA0gb5BPwQ","AIzaSyDNRjXJzwlbeRKoAAcUz2srGDCU8L7RvJ8","AIzaSyBeiyyjkhrntT7zKUfjNPLv1iSbh4mmUNE","AIzaSyCmkGQmD-eUO7JjRbCAA7T83nVAYrISeco","AIzaSyD86BbKiblVGeEXTj0zcJJJGrVi5trlerc","AIzaSyA6ZnLjnvXBipaM6PxC9F4i069iQBoiiD4","AIzaSyDTLZQPW7lD7rb5rgweqOwI65kkezcmN9Y","AIzaSyA1S80z6-kUUM7ZJ5DVLUp4WzM2cE8b09E","AIzaSyBITVzZ9nVjlBPwhoRYwdkmXxIvPezpHns","AIzaSyAmMwpF0rJJRKZN05i-AC9PJrxCMnCfMI4"];apiIndex>=t.length&&(apiIndex=0);const r={method:"post",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key="+t[apiIndex],headers:{"Content-Type":"application/json"},proxy:{protocol:"http",host:"127.0.0.1",port:7890},data:{generationConfig:{temperature:1,topP:.95,topK:40,maxOutputTokens:8192,responseMimeType:"text/plain"},contents:[{parts:[{text:e}]}]},timeout:8e3};try{const e=await axios.request(r);console.log("Status:",e.status),e.data&&e.data.candidates&&e.data.candidates[0];const t=["data","candidates","content","text"];if(propertyChecker.hasAnyRequiredProperties(e,t)){const t=e.data.candidates[0].content;return t.apiError="normal!",t.reqStatus="success",t}{const t=e;return t.apiError="接口请求未成功！请检查地址或网络!",console.log("result2:",t.status),t.reqStatus="error",t}}catch(e){const t={};return e.response?(console.log("Error Response Status:",e.response.status),t.reqStatus="ErrorResponse",t.error=e.response.data):e.request?(console.log("Request was made but no response received"),t.reqStatus="ErrorRequest",t.error="No response received"):(console.log("Error Details:",e.message),console.log("Error Config:",e.config),t.reqStatus="ErrorMessage",t.error=e.message),t}finally{console.log("API Key Index:",apiIndex+1),console.log("Request URL:",r.url),apiIndex++}}module.exports=generateContent;