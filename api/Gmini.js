const propertyChecker=require("../plugins/inTypeOf"),axios=require("axios");let apiIndex=0;async function generateContent(e){const t=["AIzaSyCBCJqcFJPWfVnxmwv2kiDX1Mb7hLLYYew","AIzaSyDiyqOVlm4ticaSmMwpuR1UteI43ytXvCY","AIzaSyDSCyLfYGCyI2uqlGTt6CwOoGQF0EpcNn0","AIzaSyC8INbh50rAr5ZJQ1L22iA0pQs-QhHxSOI","AIzaSyBS6tmfrFeLomXZPlBs7cczYEjzVFsHZVw","AIzaSyC8INbh50rAr5ZJQ1L22iA0pQs-QhHxSOI","AIzaSyBITVzZ9nVjlBPwhoRYwdkmXxIvPezpHns","AIzaSyAmMwpF0rJJRKZN05i-AC9PJrxCMnCfMI4"];apiIndex>=t.length&&(apiIndex=0);const o={method:"post",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key="+t[apiIndex],headers:{"Content-Type":"application/json"},data:{generationConfig:{temperature:1,topP:.95,topK:40,maxOutputTokens:8192,responseMimeType:"text/plain"},contents:[{parts:[{text:e}]}]},timeout:18e3};try{const e=await axios.request(o);console.log("Status:",e.status),e.data&&e.data.candidates&&e.data.candidates[0];const t=["data","candidates","content","text"];if(propertyChecker.hasAnyRequiredProperties(e,t)){const t=e.data.candidates[0].content;return t.apiError="normal!",t.reqStatus="success",t}{const t=e;return t.apiError="接口请求未成功！请检查地址或网络!",console.log("result2:",t.status),t.reqStatus="error",t}}catch(e){console.log("\n=== Error Details ===");const t={};return e.response?(console.log("Error Response Status:",e.response.status),t.reqStatus="ErrorResponse",t.error=e.response.data):e.request?(console.log("Request was made but no response received"),console.log("Request Details:",e.request),t.reqStatus="ErrorRequest",t.error="No response received"):(console.log("Error Details:",e.message),console.log("Error Config:",e.config),t.reqStatus="ErrorMessage",t.error=e.message),console.log("=== End Error Details ===\n"),console.log("requestStatus:",t),t}finally{console.log("API Key Index:",apiIndex+1),console.log("Request URL:",o.url),apiIndex++}}module.exports=generateContent;